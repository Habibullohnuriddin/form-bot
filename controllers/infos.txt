* isds *
const channelIds = ['-1001475071730', '-1001784566133', '-1001238383367']


* links *
https://t.me/Kompyuter_Kursi15KUN,
https://t.me/Kompyuter_kursi15,
https://t.me/K24_nomerkerakbot


* test uchun ma'lumot kiritsh *
const newUserSchema = new userSchema({
    firstname: 'Habibulloh',
    lastname: 'Nuriddinov',
    age: 21,
    location: "Tashkent",
    phoneNumber: +998909888954,
    whereIsFind: "Telegram",
    hasComputer: 'yes',
    hasInternet: "no",
    hasSoftware: "yes",
  });
  newUserSchema.save()
    .then(() => {
      console.log('Yangi foydalanuvchi saqlandi');
      mongoose.connection.close();
    })
    .catch((err) => {
      console.log('Foydalanuvchi saqlashda xatolik yuzaga keldi:', err);
      mongoose.connection.close();
    });



const userForm = (ctx) => {
bot.telegram.sendMessage(ctx.chat.id, `<strong>Salom!</strong>, @${ctx.from.username}.`, { parse_mode: 'HTML' })
}





* post osti buttoni *

// const buttons = [
//   { text: 'Ha', callback_data: 'yes' },
//   { text: 'Yo`q', callback_data: 'no' }
// ];

// // Command buttonlarga javob berish
// bot.inlineQuery('yes', (ctx) => {
//   ctx.reply('Yordam kerak bo`lsa, menga yozing!');
// });

// bot.action('no', (ctx) => {
//   ctx.reply('Rahmat, yordam kerak bo`lsa, yana keling!');
// });




* contact *

const contact_keyboard = {
  keyboard: [
    [
      {
        text: 'Contact',
        request_contact: true,
      },
    ],
    ['Cancel'],
  ],
  resize_keyboard: true,
  one_time_keyboard: true,
}



* location *

          reply_markup: {
            keyboard: [
              [
                {
                  text: 'üìç Joyingizning geolokatsiyasini yuborish',
                  request_location: true,
                },
              ],
              [{ text: 'üìù Joyingizning manzilini yuborish' }],
            ],
            resize_keyboard: true,
            one_time_keyboard: true,
          },

---------
  clg = `Sizning geolokatsiyangiz: (${user.location.latitude}, ${user.location.longitude})`
---------
    if (!user.location) {
      if (ctx.message.location) {
        const { latitude, longitude } = ctx.message.location;
        user.location = { latitude, longitude };
      } else {
        user.location = ctx.message.text;
      }
      console.log(user);
      return ctx.reply('Telefon raqamingizni kiriting?' && `Sizning geolokatsiyangiz: (${user.location.latitude}, ${user.location.longitude})`)
    }


* location schema *

 location: {
    type: {
      type: String,
      enum: ['Point'],
      required: false,
    },
    coordinates: {
      type: [Number],
      required: false,
    },
    address: {
      type: String,
      required: false,
    },
  },




const { default: fetch } = require('node-fetch');

bot.command('members', async (ctx) => {
  if (!ctx.message.reply_to_message) {
    return ctx.replyWithHTML('Guruh foydalanuvchisini <strong>–æ—Ç–º–µ—Ç–∫–∞</strong>/<strong>reply</strong> qilib /members komandasini yuboring.');
  }

  const targetUser = ctx.message.reply_to_message.from.id;
  const chatId = ctx.message.chat.id;

  try {
    const membersCount = await getInvitedMembersCount(chatId, targetUser);

    ctx.reply(`@${ctx.message.reply_to_message.from.username} guruhga ${membersCount} ta odam qo'shgan.`);
  }
  catch (error) {
    console.error(error);
    ctx.reply(`Xatolik yuz berdi. Iltimos, qayta urinib ko\'ring.`);
  }
});

async function getInvitedMembersCount(chatId, userId) {
  const apiUrl = `https://api.telegram.org/bot${bot.token}/getChatMember`;
  const response = await fetch(`${apiUrl}?chat_id=${chatId}&user_id=${userId}`);
  const data = await response.json();

  if (data.ok && (data.result.status === 'administrator' || data.result.status === 'creator' || data.result.status === 'member')) {

    const invitedMembersCount = data.result.invited_member_count;
    console.log(invitedMembersCount)
    return invitedMembersCount;
  }

  throw new Error('Foydalanuvchi guruh boshqaruvchisi emas.');
}



* Location function *

// function handleLocation(ctx) {
//   const { latitude, longitude } = ctx.message.location;

//   return telegram.sendLocation(latitude, longitude);
// }

// const location_keyboard = [
//   [{ text: 'üìç Joyingizning geolokatsiyasini yuborish', request_location: true }],
//   [{ text: 'üìù Joyingizning manzilini yuborish', }],
// ]